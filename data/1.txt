Combinatorial Analysis 1.1 Introduction This chapter deals with ﬁnding eﬀective methods for counting the number of ways that things can occur. In fact, many problems in probability theory can be solved simply by counting the number of diﬀerent ways that a certain event can occur. The mathematical theory of counting is formally known as combinatorial analysis. 1.2 The Basic Principle of Counting Number of ways to perform two procedures in succession : If we are going to perform two procedures in succession and if the ﬁrst procedure can be performed in n 1 ways, and if, for each of these ways, the second procedure can be performed in n 2 ways, then there are n 1 n 2 ways in which the two procedures can be performed successively. Number of ways to perform several procedures in succession : Similarly, if we are performing r proce- dures successively, the i th procedure capable of being performed in n i ways regardless of the ways in which the ﬁrst ( i − 1 ) procedures were performed, then the r procedures can be performed in n 1 n 2 · · · n r diﬀerent ways. 1.3 Permutations Number of ways to order n distinct elements : Based on the reasoning mentioned earlier, if we have n dis- tinct elements, there would be n × ( n − 1) × ( n − 2) × · · · × 2 × 1 ways of ordering them. We denote this quantity by n ! and in words by n factorial. ©A. K. Khandani, E&CE307—Fall 2024 2 Number of ways to order n elements (which may not be distinct) : The number of distinct orderings of n objects, n 1 of which are type 1 , n 2 of which are of type 2 , . . . , and n r of which are of type r , is equal to:  n n 1 , n 2 , . . . , n r ! = n ! n 1 ! n 2 ! · · · n r !  , n 1 + n 2 + . . . n r = n Number of ways to select r elements from n elements (order is important) : The total number of ways of ordering r elements, chosen from n distinct elements, is equal to: n ( n − 1)( n − 2) · · · ( n − r + 1) This quantity can be also expressed as n ! / ( n − r )! . This is denoted by P  n r  , the number of permutations of n things taken r at a time. 1.4 Combinations Number of ways to select r elements from n distinct elements (order is not important) : It is possi- ble to choose, without regard of order, r elements from n distinct elements in n ! r !( n − r )! diﬀerent ways. This is an important quantity in combinatorics and will be denoted by  n r ! . It is also called a Binomial Coeﬃcient and is sometimes written as C n r  . ©A. K. Khandani, E&CE307—Fall 2024 3 Note that,  n 0 ! =  n n ! = 1 and  n i ! = 0 , for i < 0 , and for i > n A useful combinatorial identity is,  n r ! =  n − 1 r − 1 ! +  n − 1 r ! , 1 ≤ r ≤ n This identity may be proved by the following combinatorial argument. Consider a group of n objects and ﬁx attention on some particular one of these objects (call it object 1). Now, there are  n − 1 r − 1 ! groups of size r that contain object 1. (since each such group is formed by selecting r − 1 objects from the n − 1 objects which are those remaining after excluding object 1). Also, there are  n − 1 r ! groups of size r that do not contain object 1 (since each such group is formed by selecting r objects from the n − 1 objects which are those remaining after excluding object 1). Note that there is a total of  n r ! groups of size r , and a given group among these either contains or does not contain object 1. This means that the total number of possible ways to select r objects out of n is equal to the number of ways to select r object from n when object 1 is included (total of  n − 1 r − 1 ! groups) plus the number of ways to select r object from n when object 1 is not included (total of  n − 1 r ! groups). This results in the above identity. We also have,  n r ! =  n n − r ! ©A. K. Khandani, E&CE307—Fall 2024 4 Binomial Theorem is as follows: ( X + Y ) n  = n X k =0  n k ! X k Y  n − k Combinatorial Proof of the Binomial Theorem: Consider the product ( X 1 + Y 1 )( X 2 + Y 2 ) . . . ( X n + Y n ) Its expansion consists of the sum of 2 n  terms, each term being the product of n factors. Furthermore, each of the 2 n  terms in the sum will contain as a factor either X i or Y i for each i = 1 , 2 , ..., n . For example, ( X 1 + Y 1 )( X 2 + Y 2 ) = X 1 X 2 + X 1 Y 2 + Y 1 X 2 + Y 1 Y 2 Now, how many of the 2 n  terms in the sum will have as factors k of the X i ’s and ( n − k ) of the Y i ’s? As each term consisting of k of the X i ’s and ( n − k ) of the Y i ’s corresponds to a choice of a group of k from the n values X 1 , X 2 , ..., X n , there are  n k ! such terms. Thus, letting X i = X , Y i = Y , i = 1 , ..., n , we get the desired result. 1.5 Multinomial Coeﬃcients Multinomial Theorem is as follows: ( x 1 + x 2 + · · · + x r ) n  = X  n n 1 , n 2 . . . , n r ! x n 1 1  x n 2 2  · · · x n r r where n 1 + n 2 + · · · + n r = n , and  n n 1 , n 2 . . . , n r ! = n ! n 1 ! n 2 ! · · · n r ! and the summation is over all possible sets of integers ( n 1 , n 2 , . . . , n r ) such that (i) 0 ≤ n i ≤ n, i = 1 , 2 , . . . , r and (ii) n 1 + n 2 + · · · + n r = n . ©A. K. Khandani, E&CE307—Fall 2024 5 1.6 The Number of Integer Solutions of Equations The Number of Positive Integer Solutions of Equations : There are  n − 1 r − 1 ! distinct positive integer-valued vectors ( x 1 , x 2 , . . . , x r ) satisfying: x 1 + x 2 + · · · + x r = n x i > 0 , i = 1 , . . . , r Proof: Refer to problem 7. The Number of Nonnegative Integer Solutions of Equations : There are  n + r − 1 r − 1 ! distinct nonnega- tive integer-valued vectors ( x 1 , x 2 , . . . , x r ) satisfying: x 1 + x 2 + · · · + x r = n x i ≥ 0 , i = 1 , . . . , r Proof: Refer to problem 8. ©A. K. Khandani, E&CE307—Fall 2024 6 1.7 Some Solved Problems 1. Twenty books are to be arranged on a shelf; eleven on travel, ﬁve on cooking, and four on gardening. The books in each category are to be grouped together. How many arrangements are possible? Solution: We have 11! arrangements for the travel, 5! arrangements for the cooking, and 4! arrangements for the gardening books. We can also permute the three diﬀerent classes of books in 3! ways. Thus total = (11!)(5!)(4!)(3!) 2. A sandwich in a vending machine costs $0.85. In how many ways can a customer put in two quarters, three dimes, and a nickel? Solution: We know that the number of ways to arrange n objects, n 1 of one kind, n 2 of a second kind, . . . , and n r of an r th kind, r X i =1 n i = n , is n ! n 1 ! n 2 ! · · · n r ! Viewed in this context, an admissible coin sequence is a permutation of n = n 1 + n 2 + n 3 = 6 objects, where n 1 = number of quarters = 2 n 2 = number of dimes = 3 n 3 = number of nickels = 1 It follows that the number of diﬀerent ways the coins can be put into the machine is 60: n ! n 1 ! n 2 ! n 3 ! = 6! 2!3!1! = 60 3. Twelve people belong to a club. How many ways can they pick a president, vice-president, secretary, and treasurer? Solution: We think of ﬁlling the oﬃces one at a time. There are 12 people we can pick for president. Having made the ﬁrst choice, there are always 11 possibilities for vice-president, 10 for secretary, and 9 for treasurer. The Multiplication rule states that, if m experiments are performed in order and that, no matter what the outcomes of experiments 1 , ..., k − 1 are, experiment k has n k possible outcomes, then the total number of outcomes is n 1 · n 2 · · · n m . So by the multiplication rule, the answer is 12 P  · 11 V  · 10 S  · 9 T 4. A committee of three consisting of two men and one woman is to be chosen from six men and three women. How many diﬀerent committees can be chosen? Solution: The two men can be chosen in C 6 2  ways. The one woman can be chosen in C 3 1  ways. Thus the total number of diﬀerent possible committees is ( C 6 2 )( C 3 1 ) =  6 2 ! 3 1 ! = 6! 4!2!  · 3! 2! = 45 5. In a class of 70 students, how many ways can the students be grouped so that there are 12 students in each of the ﬁrst ﬁve groups and 10 students in the last one? ©A. K. Khandani, E&CE307—Fall 2024 7 Solution: There are C 70 12  choices for the ﬁrst group. Having chosen 12 for the ﬁrst group, there remain C 58 12 choices for the second group and so on. By the multiplication principle, the total is total =  70 12 ! .  58 12 ! .  46 12 ! .  34 12 ! .  22 12 ! .  10 10 ! = 70! 58!12!  · 58! 46!12!  · 46! 34!12!  · 34! 22!12!  · 22! 10!12!  · 10! 0!10! = 70! (12!) 5 10! 6. A house has 12 rooms. We want to paint 4 yellow, 3 purple, and 5 red. In how many ways can this be done? Solution: To generate all the possibilities, we can ﬁrst decide the order in which the rooms will be painted, which can be done in 12! ways, then paint the ﬁrst 4 on the list yellow, the next 3 purple, and the last 5 red. One example is 9 Y 6 Y 11 Y 1 Y 8 P 2 P 10 P 5 R 3 R 7 R 12 R 4 R Now, the ﬁrst four choices can be rearranged in 4! ways without aﬀecting the outcome, the middle three in 3! ways, and the last ﬁve in 5! ways. Invoking the multiplication rule, we see that in a list of the 12! possible permutations each possible painting thus appears 4!3!5! times. Hence, the number of possible paintings is 12! 4!3!5! = 12 · 11 · 10 · 9 · 8 · 7 · 6 1 · 2 · 3 · 1 · 2 · 3 · 4 = 27 , 720 Another way of getting the last answer is to ﬁrst pick 4 of 12 rooms to be painted yellow, which can be done in C 12 4 ways, and then pick 3 of the remaining 8 rooms to be painted purple, which can be done in C 8 3  ways. (The 5 unchosen rooms will be painted red.) This is the same answer since C 12 4  C 8 3  = 12! 4!8!  · 8! 3!5! = 12! 4!3!5! 7. How many ways can we divide n indistinguishable balls into r distinguishable groups in such a way that there is at least one ball per group? Solution: To solve this problem we imagine a line of n white balls and r − 1 pieces of cardboard to place between them to indicate the boundaries of the groups. An example with n = 14 and r = 6 would be ooo | o | oo | oooo | ooo | o Since we must pick r − 1 of the n − 1 spaces to put our cardboard dividers into, there are  n − 1 r − 1 ! possibilities. When the groups can have size 0, the last scheme breaks down and we need to look at things in a diﬀerent way. We imagine having n white balls ( w ’s) and r − 1 black balls ( b ’s) that will indicate the boundaries between groups. An example with n = 9 , r = 6 would be w w b b w w w w b w b w w b which corresponds to groups of size n 1 = 2 , n 2 = 0 , n 3 = 4 , n 4 = 1 , n 5 = 2 , and n 6 = 0 . Each possible division of n indistinguishable balls into r boxes corresponds to one arrangement of the n white balls and r − 1 black balls, which is in turn the same as the number of ways of getting n heads and r − 1 tails in n + r − 1 tosses, so there are  n + r − 1 r − 1 ! outcomes. ©A. K. Khandani, E&CE307—Fall 2024 8 8. Show that there are  n + r − 1 n ! distinct nonnegative integer-valued vectors with components ( x 1 , x 2 , . . . , x r ) satisfying x 1 + x 2 + . . . + x r = n Solution: Consider a vector consisting of n ones and ( r − 1 ) zeros. To each permutation of this vector we correspond a solution of the above equation, namely, the solution where x 1 equals the number of ones to the left of the ﬁrst zero, x 2 equals the number of ones between the ﬁrst and second zeros, x 3 equals the number of ones between the second and third zeros, and so on until x r , which equals the number of ones to the right of the last zero. For instance, if n = 6, r = 4, then the vector (1,1,0,0,1,1,1,0,1) corresponds to the solution x 1 = 2, x 2 = 0, x 3 = 3, x 4 = 1. It is easy to see that this correspondence between permutations of a vector of n ones and ( r − 1 ) zeros and solutions of the above equation is a one-to-one correspondence. The result now follows because there are  ( n + r − 1)! n !( r − 1)! permutations of a vector of n ones and ( r − 1 ) zeros. Try to relate this problem to the previous problem. 9. Show that  n 1 ! +  n 3 ! + · · · =  n 0 ! +  n 2 ! + · · · for any n . Solution: Consider the expansion of ( x − y ) n : ( x − y ) n  = n X k =0  n k ! x k ( − y ) n − k Let x = y = 1. Then x − y = 0, and the previous equation reduces to 0 = n X k =0  n k ! ( − 1) n − k which can be written  n 0 ! +  n 2 ! + · · · =  n 1 ! +  n 3 ! + · · · 10. Prove that  n 1 ! + 2  n 2 ! + · · · + n  n n ! = n 2 n − 1 Solution: This time we begin with the expansion of (1 + x ) n : (1 + x ) n  = n X k =0  n k ! x k (1) n − k Diﬀerentiating both sides of the previous equation with respect to x gives n (1 + x ) n − 1  = n X k =0  n k ! kx k − 1 Now, let x = 1. This simpliﬁes the left-hand side of the previous equation to n 2 n − 1 , while the right-hand side reduces to n X k =0 k  n k ! =  n 1 ! + 2  n 2 ! + · · · + n  n n ! ©A. K. Khandani, E&CE307—Fall 2024 9