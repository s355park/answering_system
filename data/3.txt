Conditional Probability and Independence 3.1 Introduction In this chapter we introduce one of the most important concepts in probability theory, that of conditional probabil- ity. The importance of this concept is twofold. In the ﬁrst place, we are often interested in calculating probabilities when some partial information concerning the result of the experiment is available; in such a situation the desired probabilities are conditional. Second, even when no partial information is available, conditional probabilities can often be used to compute the desired probabilities more easily. 3.2 Conditional Probabilities Conditional Probability : Consider two events E and F which are somehow interrelated (are dependent on each other). The conditional probability of E given F is deﬁned as, P ( E | F ) =  P ( EF ) P ( F )  , if P ( F ) ̸ = 0 . If P ( F ) = 0 , then the conditional probability is not deﬁned. The multiplication rule P ( E 1 E 2 E 3 · · · E n ) = P ( E 1 ) P ( E 2 | E 1 ) P ( E 3 | E 1 E 2 ) · · · P ( E n | E 1 E 2 . . . E n − 1 ) ©A. K. Khandani, E&CE307—Fall 2024 28 3.3 Bayes’ formula For any two events E and F , P ( E ) = P ( EF ) + P ( EF  c ) = P ( E | F ) P ( F ) + P ( E | F  c ) P ( F  c ) = P ( E | F ) P ( F ) + P ( E | F  c )[1 − P ( F )] The Odds Ratio of an event A is deﬁned by: P ( A ) P ( A c ) = P ( A ) 1 − P ( A ) Consider a hypothesis H that is true with probability of P ( H ) and suppose that new evidence E is introduced. Then the conditional probabilities, given the evidence E , that H is true and that H is not true are given by P ( H | E ) =  P ( E | H ) P ( H ) P ( E ) P ( H c | E ) =  P ( E | H c ) P ( H c ) P ( E ) Therefore, the new odds ratio after the evidence E has been introduced as P ( H | E ) P ( H c | E ) = P ( H ) P ( H c ) P ( E | H ) P ( E | H c ) That is, the new value of odds ratio of H is its old value multiplied by the ratio of the conditional probability of the new evidence given that H is true to the conditional probability given that H is not true. ©A. K. Khandani, E&CE307—Fall 2024 29 Bayes’ formula : Suppose that F 1 , F 2 , . . . , F n are mutually exclusive events such that n [ i =1 F i = S , then P ( F j | E ) = P ( EF j ) P ( E ) = P ( E | F j ) P ( F j ) n X i =1 P ( E | F i ) P ( F i ) 3.4 Independent Events Two Independent Events : Two events E and F are independent if P ( EF ) = P ( E ) P ( F ) then P ( E | F ) = P ( E ) and P ( F | E ) = P ( F ) . If E and F are independent, then so are E and F  c , as well as E c  and F and also E c  and F  c . ©A. K. Khandani, E&CE307—Fall 2024 30 Three Independent Events : The three events E, F and G are independent if P ( EFG ) = P ( E ) P ( F ) P ( G ) P ( EF ) = P ( E ) P ( F ) P ( EG ) = P ( E ) P ( G ) P ( FG ) = P ( F ) P ( G ) Independent Events : Similarly, the events E i , i = 1 , 2 , . . . , n , are called independent if and only if for any collection of r distinct indices ( α 1 , α 2 , . . . , α r ) chosen from the set 1 , 2 , . . . , n , we have, P ( Eα 1 Eα 2 · · · Eα r ) = P ( Eα 1 ) P ( Eα 2 ) · · · P ( Eα r ) 3.5 P ( ·| F ) Is a Probability Conditional Probabilities satisfy all of the properties of ordinary probabilities. That is: (a) 0 ≤ P ( E | F ) ≤ 1 . (b) P ( S | F ) = 1 . (c) If E 1 , E 2 , . . . are disjoint events, then P [ i E i | F ! = X i P ( E i | F ) ©A. K. Khandani, E&CE307—Fall 2024 31 3.6 Some Solved Problems 1. Consider a die with 1 painted on three sides, 2 painted on two sides, and 3 painted on one side. If we roll this die ten times what is the probability we get ﬁve 1’s, three 2’s and two 3’s? Solution: The answer is 10! 5!3!2!  1 2  5  1 3  3  1 6  2 If we have a group of n objects to be divided into m groups of size n 1 , ..., n m with n 1 + · · · + n m = n this can be done in n ! n 1 ! n 2 ! · · · n m !  ways The ﬁrst factor, in the answer above, gives the number of ways to pick ﬁve rolls for 1’s, three rolls for 2’s, and two rolls for 3’s. The second factor gives the probability of any outcome with ﬁve 1’s, three 2’s, and two 3’s. Generalizing from this example, we see that if we have k possible outcomes for our experiment with probabilities p 1 , ..., p k then the probability of getting exactly n i outcomes of type i in n = n 1 + ... + n k trials is n ! n 1 ! · · · n k ! p n 1 1  · · · p n k k since the ﬁrst factor gives the number of outcomes and the second the probability of each one. We referred to this as the Multinomial Distribution . 2. Suppose an urn contains r = 1 red chip and w = 1 white chip. One is drawn at random. If the chip selected is red, that chip along with k = 2 additional red chips are put back into the urn. If it is white, the chip is simply returned to the urn, then a second chip is drawn. What is the probability that both selections are red? Solution: If we let R 1 be the event “red chip is selected on ﬁrst draw” and R 2 be “red chip is selected on second draw,” it should be clear that P ( R 1 ) = 1 2 and P ( R 2 | R 1 ) = 3 4 We also know that P ( AB ) = P ( A | B ) P ( B ) Hence, substituting the probabilities we found into the above equation gives P ( R 1 R 2 ) = P ( both chips are red ) = P ( R 1 ) P ( R 2 | R 1 ) =  1 2   3 4  = 3 8 3. At a party n men take oﬀtheir hats. The hats are then mixed up and each man randomly selects one. We say that a match occurs if a man selects his own hat. 1. What is the probability of no matches? 2. What is the probability of exactly k matches? Solution: We can solve this problem using the corresponding formulas for matching problem. However, in the following, we examine a diﬀerent approach using conditional probability. Let E denote the event that no matches occur, and to make explicit the dependence on n write P n = P ( E ) . We start by conditioning on whether or not the ﬁrst man selects his own hat-call these events M and M c . Then P n = P ( E ) = P ( E | M ) P ( M ) + P ( E | M c ) P ( M c ) (1) ©A. K. Khandani, E&CE307—Fall 2024 32 Clearly, P ( E | M ) = 0 , and so P n = P ( E | M c ) n − 1 n Now, P ( E | M c ) is the probability of no matches when n − 1 men select from a set of n − 1 hats that does not contain the hat of one of these men. This can happen in either of two mutually exclusive ways. Either there are no matches and the extra man does not select the extra hat (this being the hat of the man that chose ﬁrst), or there are no matches and the extra man does select the extra hat. The probability of the ﬁrst of these events is just P n − 1 , which is seen by regarding the extra hat as “belonging” to the extra man. As the second event has probability [1 / ( n − 1)] P n − 2 , we have P ( E | M c ) = P n − 1 + 1 n − 1 P n − 2 and thus, from Equation (1), P n =  n − 1 n P n − 1 + 1 n P n − 2 or equivalently P n − P n − 1 = − 1 n ( P n − 1 − P n − 2 ) (2) However, as P n is the probability of no matches when n men select among their own hats, we have P 1 = 0 P 2 = 1 2 and so, from Equation (2), P 3 − P 2 = − ( P 2 − P 1 ) 3 = − 1 3!  or P 3 = 1 2!  − 1 3! P 4 − P 3 = − ( P 3 − P 2 ) 4 = 1 4!  or P 4 = 1 2!  − 1 3! + 1 4! and, in general, we see that P n = 1 2!  − 1 3! + 1 4!  −· · · + ( − 1) n n ! To obtain the probability of exactly k matches, we consider any ﬁxed group of k men. The probability that they, and only they, select their own hats is 1 n 1 n − 1  · · · 1 n − ( k − 1) P n − k = ( n − k )! n ! P n − k where P n − k is the probability that the other n − k men, selecting among their own hats, have no matches. As there are  n k ! choices of a set of k men, the desired probability of exactly k matches is P n − k k ! = 1 2!  − 1 3! + · · · + ( − 1) n − k ( n − k )! k ! 4. In a batch of 50 units there are 5 defectives. A unit is selected at random, and thereafter one more from the remaining ones. Find the probability that both are defective. Solution: Let A be the event that “the ﬁrst unit is defective” and B the event that “the second unit is defective”. It is seen that P ( A ) = 5 / 50 . If A occurs, there remain 49 units, 4 of which are defective. Hence we conclude that P ( A | B ) = 4 / 49 , and using the following formula P ( AB ) = P ( A ) P ( B | A ) = P ( B ) P ( A | B ) ©A. K. Khandani, E&CE307—Fall 2024 33 we arrive at the probability we seek: P ( AB ) = 5 50  · 4 49 = 2 245 Let us now draw a third unit, and let us evaluate the probability that the ﬁrst two units are defective and that the third one is good. If C is the event that “the third unit is good”, and we employ the top formula twice to get the following formula for three events P ( ABC ) = P ( AB ) P ( C | ( AB )) = P ( A ) P ( B | A ) P ( C | ( AB )) we arrive at our ﬁnal answer P ( ABC ) = 5 50  · 4 49  · 45 48 = 3 392 5. In a factory, units are manufactured by machines H 1 , H 2 , H 3 in the proportions 25 : 35 : 40 . The percentages 5% , 4% and 2% , respectively, of the manufactured units are defective. The units are mixed and sent to the customers. (a) Find the probability that a randomly chosen unit is defective. (b) Suppose that a customer discovers that a certain unit is defective. What is the probability that it has been manufactured by machine H 1 ? Solution: (a) The Total Probability Theorem states that if the events H 1 , H 2 ,..., H n are mutually exclusive, have positive probabilities, and together ﬁll the probability space Ω completely, any event A satisﬁes the formula P ( A ) = n X i =1 P ( H i ) P ( A | H i ) Using this theorem, and taking H i = “unit produced by machine H i ” and A=“unit is defective”, we ﬁnd P ( A ) = 0 . 25 · 0 . 05 + 0 . 35 · 0 . 04 + 0 . 40 · 0 . 02 = 0 . 0345 . (b) Bayes’ Theorem states that, under the same conditions as the Total Probability Theorem (see part (a)), P ( H i | A ) = P ( H i ) P ( A | H i ) n X j =1 P ( H j ) P ( A | H j ) Hence Bayes’ theorem gives the answer ( A = defective unit) P ( H 1 | A ) = 0 . 25 · 0 . 05 0 . 25 · 0 . 05 + 0 . 35 · 0 . 04 + 0 . 40 · 0 . 02 = 0 . 36 6. In a certain country there are two nationalities living together, the Bigs and the Smalls. Among the Bigs 80% are tall, and among the Smalls 1%. A visiting tourist encounters a person at random who turns out to be tall. Determine the probability that this person belongs to the Bigs. Solution: Let H 1 = “the person belongs to the Bigs”, H 2 = “the person belongs to the Smalls”, A=“the person is tall”. Bayes’ theorem shows that P ( H 1 | A ) = P ( H 1 ) · 0 . 80 P ( H 1 ) · 0 . 80 + P ( H 2 ) · 0 . 01 . The formulation of the problem is inadequate, since it is necessary to know the probabilities P ( H 1 ) and P ( H 2 ) , the proportions of Bigs and Smalls in the country. If the proportions are the same, so that P ( H 1 ) = P ( H 2 ) = 1 / 2 , the probability becomes 80 / 81 = 0 . 99 . But if the Bigs are so few that P ( H 1 ) = 0 . 001 and P ( H 2 ) = 0 . 999 , the probability is instead 0 . 001 · 0 . 80 / (0 . 001 · 0 . 80 + 0 . 999 · 0 . 01) = 80 / 1079 = 0 . 08 . ©A. K. Khandani, E&CE307—Fall 2024 34 7. Al ﬂips 3 coins and Betty ﬂips 2. Al wins if the number of Heads he gets is more than the number Betty gets. What is the probability Al will win? Solution: Let A be the event that Al wins, let B i be the event that Betty gets i Heads, and let C j be the event that Al gets j Heads. By considering the four outcomes of ﬂipping two coins it is easy to see that P ( B 0 ) = 1 / 4 P ( B 1 ) = 1 / 2 P ( B 2 ) = 1 / 4 while considering the eight outcomes for three coins leads to P ( A | B 0 ) = P ( C 1 ∪ C 2 ∪ C 3 ) = 7 / 8 P ( A | B 1 ) = P ( C 2 ∪ C 3 ) = 4 / 8 P ( A | B 2 ) = P ( C 3 ) = 1 / 8 Since AB i , i = 0 , 1 , 2 are disjoint and their union is A , we have P ( A ) = 2 X i =0 P ( AB i ) = 2 X i =0 P ( A | B i ) P ( B i ) since P ( AB i ) = P ( A | B i ) P ( B i ) by the deﬁnition of conditional probability. Plugging in the values, we obtain, P ( A ) = 1 4  · 7 8 + 2 4  · 4 8 + 1 4  · 1 8 = 7 + 8 + 1 32 = 1 2 8. Suppose for simplicity that the number of children in a family is 1 , 2 , or 3 , with probability 1 / 3 each. Little Bobby has no brothers. What is the probability he is an only child? Solution: Let B 1 , B 2 , B 3 be the events that a family has one, two, or three children, and let A be the event that a family has only one boy. We want to compute P ( B 1 | A ) . By the deﬁnition of conditional probability, we have, P ( B 1 | A ) = P ( B 1 A ) /P ( A ) To evaluate the numerator we again use the deﬁnition of conditional probability P ( B 1 A ) = P ( B 1 ) P ( A | B 1 ) = 1 3  · 1 2 = 1 6 Similarly, P ( B 2 A ) = P ( B 2 ) P ( A | B 2 ) = 1 3  · 2 4 = 1 6  and P ( B 3 A ) = P ( B 3 ) P ( A | B 3 ) = 1 3  · 3 8 = 1 8 Now P ( A ) = X i P ( B i A ) so P ( B 1 | A ) =  P ( B 1 A ) P ( A ) = 1 / 6 1 / 6 + 1 / 6 + 1 / 8 = 8 8 + 8 + 6 = 4 11 9. A company buys tires from two suppliers, 1 and 2. Supplier 1 has a record of delivering tires containing 10% defectives, whereas supplier 2 has a defective rate of only 5% . Suppose 40% of the current supply came from supplier 1. If a tire is taken from this supply and observed to be defective, ﬁnd the probability that it came from Supplier 1. ©A. K. Khandani, E&CE307—Fall 2024 35 Solution: Let B i denote the event that a tire comes from supplier i , i = 1,2, and note that B 1 and B 2 form a partition of the sample space for the experiment of selecting one tire. Let A denote the event that the selected tire is defective. Then, P ( B 1 | A ) = P ( B 1 ) P ( A | B 1 ) P ( B 1 ) P ( A | B 1 ) + P ( B 2 ) P ( A | B 2 ) = . 40( . 10) . 40( . 10) + ( . 60)( . 05) = 0 . 04 . 04 + . 03 = 4 7 Supplier 1 has a greater probability of being the party supplying the defective tire than does Supplier 2. 10. Urn I contains 2 white and 4 red balls, whereas urn II contains 1 white and 1 red ball. A ball is randomly chosen from urn I and put in to urn II, and a ball is then randomly selected from urn II. 1) What is the probability that the ball selected from urn II is white? 2) What is the conditional probability that the transferred ball was white, given that a white ball is selected from urn II? Solution: Letting W be the event that the transferred ball was white, and E the event that the ball selected from II was white we obtain, 1) P ( E ) = P ( E | W ) P ( W ) + P ( E | W  c ) P ( W  c ) =  2 3   2 6  +  1 3   4 6  = 4 9 2) P ( W | E ) = P ( WE ) P ( E ) = P ( E | W ) P ( W ) P ( E ) = 1 2 11. A laboratory blood test is 95 per cent eﬀective in detecting a certain disease when it is, in fact, present. However, the test also yields a “false positive” result for 1 per cent of the healthy persons tested. (That is, if a healthy person is tested, then, with probability 0.01, the test result will imply he has the disease.) If 0.5 per cent of the population actually has the disease, what is the probability a person has the disease given that his test result is positive? Solution: Let D be the event that the tested person has the disease and E the event that his test result is positive. The desired probability P ( D | E ) is obtained by P ( D | E ) = P ( DE ) P ( E ) = P ( E | D ) P ( D ) P ( E | D ) P ( D ) + P ( E | D c ) P ( D c ) = ( . 95)( . 005) ( . 95)( . 005) + ( . 01)( . 995) = 95 294  ≈ . 323 ©A. K. Khandani, E&CE307—Fall 2024 36 Thus only 32 per cent of those persons whose test results are positive actually have the disease. As you may be surprised at this result (as it is expected this ﬁgure to be much higher, since the blood test seems to be a good one), it is probably worthwhile to present a second argument which, although less rigorous than the preceding one, is probably more revealing. Since 0.5 per cent of the population actually has the disease, it follows that, on the average, 1 person out of every 200 tested will have it. The test will correctly conﬁrm that this person has the disease with probability 0.95. Thus, on the average, out of every 200 persons tested the test will correctly conﬁrm that 0.95 persons have the disease. On the other hand, however, out of the (on the average) 199 healthy people, the test will incorrectly state that (199)(0.01) of these people have the disease. Hence, for every 0.95 diseased persons that the test correctly states are ill, there are (on the average) (199)(0.01) healthy persons that the test incorrectly states are ill. Hence the proportion of time that the test result is correct when it states that a person is ill is 0 . 95 0 . 95 + (199)(0 . 01) = 95 294  ≈ 0 . 323 12. A purchaser of electrical components buys them in lots of size 10. It is his policy to inspect 3 components randomly from a lot and to accept the lot only if all 3 are non-defective. If 30 per cent of the lots have 4 defective components and 70 per cent have only 1, what proportion of lots does the purchaser reject? Solution: Let A denote the event that the purchaser accepts a lot. Now, using the Total Probability Theorem P ( A ) = P ( A | lot has 4 defectives ) 3 10 + P ( A | lot has 1 defective ) 7 10 =  4 0 ! 6 3 !  10 3 !  3 10  +  1 0 ! 9 3 !  10 3 !  7 10  = 54 100 Hence 46 per cent of the lots are rejected. 13. Suppose events A, B, and C are mutually independent. Form a composite event from A and B and call it E . Is E independent of C ? Solution: Yes. 14. Suppose A and B are independent events. Does it follow that A c  and B c  are also independent? That is, does P ( A ∩ B ) = P ( A ) P ( B ) guarantee that P ( A c  ∩ B c ) = P ( A c ) P ( B c ) ? Solution: The answer is yes, the proof being accomplished by equating two diﬀerent expression for P ( A c  ∩ B c ) . First, we know that P ( A c  ∪ B c ) = P ( A c ) + P ( B c ) − P ( A c B c ) But the union of two complement is also the complement of their intersection. Therefore, P ( A c  ∪ B c ) = 1 − P ( AB ) Combining the two equations above, we get 1 − P ( AB ) = 1 − P ( A ) + 1 − P ( B ) − P ( A c B c ) ©A. K. Khandani, E&CE307—Fall 2024 37 Since A and B are independent, P ( AB ) = P ( A ) · P ( B ) , so P ( A c B c ) = 1 − P ( A ) + 1 − P ( B ) − (1 − P ( A ) P ( B )) = (1 − P ( A ))(1 − P ( B )) = P ( A c ) P ( B c ) the latter factorization implying that A c  and B c  are, themselves, independent. 15. We throw a fair four-sided die twice. Let E be the event that “the sum of the dice is 4”, and let F be the event that “the ﬁrst die thrown has value 2”. Are the events E and F independent? Solution: The sample space for this problem consists of 16 equally likely outcomes as shown graphical in ﬁgure 5. Also shown are the two events E and F .The event EF is a single outcome (2,2) with probability 1/16. 1 2 3 4 1 2 3 4 Event G : “die 2 has value 4 ” Event F : “die 1 has value 2 ” Event E : “sum of dice is 4” die 2 die 1 Figure 5: A sample space for two throws of a four-sided die. On the other hand, p ( E ) = 3 / 16 and P ( F ) = 4 / 16 , thus 3 16  . 4 16 = 3 64  ̸ = 1 16 The events E and F are therefore not independent. 16. Two coins are available, one unbiased and the other two-headed. Choose a coin at random and toss it once; assume that the unbiased coin is chosen with probability 3/4. Given that the result is head, ﬁnd the probability that the two-headed coin was chosen. Solution: The “tree diagram” shown below represents the experiment. We may take Ω to consist of the four possible paths through the tree, with each path assigned a probability equal to the product of the probabilities assigned to each branch. Notice that we are given the probabilities of the events B 1 = { unbiased coin chosen } and B 2 = { two-headed coin chosen } , as well as the conditional probabilities P ( A | B i ) , where A = { coin comes up head } . This is suﬃcient to determine the probabilities of ©A. K. Khandani, E&CE307—Fall 2024 38 two-headed unbiased H T H T 3/4 1/4 1/2 1/2 1 0 all events. Now we can compute P ( B 2 | A ) using the deﬁnition of conditional probability to obtain P ( B 2 | A ) = P ( B 2 A ) P ( A ) = P { two-headed coin chosen and coin comes up head } P { coin comes up head } = (1 / 4)(1) (3 / 4)(1 / 2) + (1 / 4)(1) = 2 5 17. Russian roulette is played with a revolver equipped with a rotatable magazine of six shots. The revolver is loaded with one shot. The ﬁrst duelist, A , rotates the magazine at random , points the revolver at his head and presses the trigger. If, afterwards, he is still alive, he hands the revolver to the other duelist, B , who acts in the same way as A . The players shoot alternately in this manner, until a shot goes oﬀ. Determine the probability that A is killed. Solution: Let T be the event that “ A is killed on the ﬁrst trial”. We have P ( A is killed ) = P ( T ) + P ( T  c ) P ( A is killed | T  c ) . But if A survives the ﬁrst trial, the roles of A and B are interchanged and so P( A is killed | T  c ) =P( B is killed)=1-P( A is killed). Inserting this above, we ﬁnd P ( A is killed ) = 1 6 + 5 6 [1 − P ( A is killed )] Solving this equation we ﬁnd P( A is killed)=6/11. 18. A toy manufacturer buys ball bearings from three diﬀerent suppliers - 50% of his total order comes from supplier 1, 30% from supplier 2, and the rest from supplier 3. Past experience has shown that the quality control standards of the three suppliers are not all the same. Of the ball bearings produced by supplier 1, 2% are defective, while suppliers 2 and 3 produce defective bearings 3% and 4% of the time, respectively. What proportion of the ball bearings in the toy manufacturer’s inventory are defective? Solution: Let A i be the event “bearing came from supplier i ,” i =1,2,3. Let B be the event “bearing in toy manufacturer’s inventory is defective.” Then P ( A 1 ) = 0 . 5 , P ( A 2 ) = 0 . 3 , P ( A 3 ) = 0 . 2 and P ( B | A 1 ) = 0 . 02 , P ( B | A 2 ) = 0 . 03 , P ( B | A 3 ) = 0 . 04 ©A. K. Khandani, E&CE307—Fall 2024 39 The Total Probability Theorem states that: Let { A 1 } n i =1  be a set of events deﬁned over S such that S = S n i =1  A i , A i A j = ∅ for i ̸ = j , and P ( A i ) > 0 for i =1,2,..., n . For any event B , we have, P ( B ) = n X i =1 P ( B | A i ) P ( A i ) Hence, combining the probabilities according to the theorem gives P ( B ) = (0 . 02)(0 . 5) + (0 . 03)(0 . 3) + (0 . 04)(0 . 2) = 0 . 027 meaning the manufacturer can expect 2.7% of his stock of ball bearings to be defective. 19. A man has n keys on a chain, one of which opens the door to his apartment. Having celebrated a little too much one evening, he returns home, only to ﬁnd himself unable to distinguish one key from another. Resourceful, he works out a ﬁendishly clever plan: He will choose a key at random and try it. If it fails to open the door, he will discard it and choose one of the remaining n − 1 keys at random, and so on. Clearly, the probability that he gains entrance with the ﬁrst key he selects is 1 /n . What is the probability the door opens with the second key he tries? Solution: It would be tempting here to answer 1/( n − 1 ), but in this case our intuition would be in error. Actually, 1/( n − 1 ) is a right answer, but to a diﬀerent question. To see why, let K i , i = 1 , 2 , . . . , n , denote the event “ i th key tried opens door.” Then P ( K 1 ) is certainly 1/ n , but the event “second key tried opens door” can occur only if the ﬁrst key does not open the door. That is, P ( K 2 ) = P ( K 2 K c 1 ) Since we also know that P ( AB ) = P ( A | B ) P ( B ) (3) applying this equation to the right-hand side of the top equation, we see that the probability that the second key tried opens the door is the same as the probability for the ﬁrst key, 1/ n : P ( K 2 K c 1 ) = P ( K 2 | K c 1 ) P ( K c 1 ) =  1 n − 1   n − 1 n  = 1 n Thus, the ratio 1/( n − 1 ) does answer a conditional probability P ( K 2 | K c 1 ) . 20. Urn I contains two white chips ( w 1 , w 2 ) and one red chip ( r 1 ); urn II has one white chip ( w 3 ) and two red chips ( r 2 , r 3 ). One chip is drawn at random from urn I and transferred to urn II. Then one chip is drawn from urn II. Suppose a red chip is selected from urn II. What is the probability the chip transferred was white? Solution: Let A 1 and A 2 denote the events “red chip is transferred from urn I” and “white chip is transferred from urn I.” Let B be the event “red chip is drawn from urn II.” What we are asking for is P ( A 2 | B ) . We note that P ( A 1 ) =  1 3 , P ( A 2 ) = 2 3 , P ( B | A 1 ) = 3 4 , and P ( B | A 2 ) = 2 4 . Bayes’ Theorem states: ©A. K. Khandani, E&CE307—Fall 2024 40 Let { A i } n i =1  be a set of n events, each with positive probability, that partition S in such a way that S n i =1  A i = S and A i A j = ∅ for i ̸ = j . For any event B (also deﬁned on S ), where P ( B ) > 0 , P ( A j | B ) = P ( B | A j ) P ( A j ) n X i =1 P ( B | A i ) P ( A i ) for any 1 ≤ j ≤ n . Therefore, we can substitute the probabilities we have found into Bayes’ formula to obtain: P ( A 2 | B ) = P ( B | A 2 ) P ( A 2 ) P ( B | A 1 ) P ( A 1 ) + P ( B | A 2 ) P ( A 2 ) =  2 4   2 3   3 4   1 3  +  2 4   2 3  = 4 7 21. Urn I contains ﬁve red chips and four white chips; urn II contains four red chips and ﬁve white chips. Two chips are to be transferred from urn I to urn II. Then a single chip is to be drawn from urn II. What is the probability the chip drawn from the second urn will be white? Solution: Let W be the event “white chip is drawn from urn II.” Let A i , i =0, 1, 2, denote the event “ i white chips are transferred from urn I to urn II.” By the Total Probability Theorem, we obtain, P ( W ) = P ( W | A 0 ) P ( A 0 ) + P ( W | A 1 ) P ( A 1 ) + P ( W | A 2 ) P ( A 2 ) Note that P ( W | A i ) = (5 + i ) / 11 and that P ( A i ) is gotten directly from the hypergeometric distribution . Therefore, P ( W ) =  5 11   4 0 ! 5 2 !  9 2 ! +  6 11   4 1 ! 5 1 !  9 2 ! +  7 11   4 2 ! 5 0 !  9 2 ! =  5 11   10 36  +  6 11   20 36  +  7 11   6 36  = 53 99 22. The highways connecting two resort areas at A and B are shown in ﬁgure below: There is a direct route through the mountains and a more-circuitous route going through a third resort area at C in the foothills. Travel between A and B during the winter months is not always possible, the roads sometimes being closed due to snow and ice. Suppose we let E 1 , E 2 , and E 3 denote the events that highways AB , AC , and CB are passable, respectively, and we know from past years that on a typical winter day, P ( E 1 ) = 2 5 , P ( E 3 | E 2 ) = 4 5 P ( E 2 ) = 3 4 , P ( E 1 | E 2 E 3 ) = 1 2 P ( E 3 ) = 2 3 ©A. K. Khandani, E&CE307—Fall 2024 41 E 1 E 3 C A B E 2 Figure 6: What is the probability that a traveller will be able to get from A to B ? Solution: If E denotes the event that we can get from A to B , then E = E 1 ∪ ( E 2 E 3 ) It follows that P ( E ) = P ( E 1 ) + P ( E 2 E 3 ) − P [ E 1 ( E 2 E 3 )] We know that, P ( E ) = P ( E 1 ) + P ( E 3 | E 2 ) P ( E 2 ) − P [ E 1 | ( E 2 E 3 )] P ( E 2 E 3 ) = P ( E 1 ) + P ( E 3 | E 2 ) P ( E 2 ) − P [ E 1 | ( E 2 E 3 )] P ( E 3 | E 2 ) P ( E 2 ) = 2 5 +  4 5   3 4  −  1 2   4 5   3 4  = 0 . 7 23. A crooked gambler has nine dice in her coat pocket: Three are fair and six are biased. The biased ones are loaded in such a way that the probability of rolling a 6 is  1 2 . She takes out one die at random and rolls it twice. Let A be the event “6 appears on the ﬁrst roll” and B be the event “6 appears on the second roll.” Are A and B independent? Solution: Our intuition here would most probably answer yes - but, appearances not withstanding, this is not a typical dice problem. Repeated throws of a die do qualify as independent events if the probabilities associated with the diﬀerent faces are known. In this situation, though, those probabilities are not know and depend in a random way on which die the gambler draws from her pocket. To see formally what eﬀect having two diﬀerent dice has on the relationship between A and B , we must appeal to the Total Probability Theorem. Let F and L denote the events “fair die selected” and “loaded die selected,” respectively. Then P ( AB ) = P ( 6 on ﬁrst roll ∩ 6 on second roll ) = P ( AB | F ) P ( F ) + P ( AB | L ) P ( L ) Conditional on either F or L , A and B are independent, so P ( AB ) =  1 6   1 6   3 9  +  1 2   1 2   6 9  =  19 108  Similarly, P ( A ) = P ( A | F ) P ( F ) + P ( A | L ) P ( L ) =  1 6   3 9  +  1 2   6 9  =  7 18  = P ( B ) ©A. K. Khandani, E&CE307—Fall 2024 42 But note that P ( AB ) = 19 108 = 57 324  ̸ = P ( A ) · P ( B ) =  7 18   7 18  =  49 324  proving that A and B are not independent. 24. Laplace’s Rule of Succession. There are k +1 biased coins in a box. The i th coin will, when ﬂipped, turn up heads with probability i/k , i =0,1,. . . , k . A coin is randomly selected from the box and is then repeatedly ﬂipped. If the ﬁrst n ﬂips all result in heads, what is the conditional probability that the ( n +1)st ﬂip will do likewise? Solution: Let E i denote the event that the i th coin is initially selected, i =0,1,. . . , k ; let F n denote the event that the ﬁrst n ﬂips all result in heads; and let F be the event that the ( n +1)st ﬂip is a head. The desired probability, P ( F | F n ) , is now obtained as follows, P ( F | F n ) = k X i =0 P ( F | F n E i ) P ( E i | F n ) Now, given that the i th coin is selected, it is reasonable to assume that the outcomes will be conditionally independent with each one resulting in a head with probability i/k . Hence P ( F | F n E i ) = P ( F | E i ) =  i k Also, P ( E i | F n ) = P ( E i F n ) P ( F n ) = P ( F n | E i ) P ( E i ) k X j =0 P ( F n | E j ) P ( E j ) = ( i/k ) n [1 / ( k + 1)] k X j =0 ( j/k ) n [1 / ( k + 1)] Hence P ( F | F n ) = k X i =0 ( i/k ) n +1 k X j =0 ( j/k ) n But if k is large, we can use the integral approximations 1 k k X i =0 ( i/k ) n +1  ≈ Z 1 0 x n +1 dx = 1 n + 2 1 k k X j =0 ( j/k ) n  ≈ Z 1 0 x n dx = 1 n + 1 and so, for k large, P ( F | F n ) ≈ n + 1 n + 2 ©A. K. Khandani, E&CE307—Fall 2024 43 25. A bag contains 3 white balls, 6 red balls and 3 black balls. Three balls are drawn at random, without replacement. What is the probability that the three balls are the same color? Solution: Let W be the event the three balls are all white, R the event the three balls are all red, B the event the three balls are all black and C the event the balls are of the same color. Then by the theorem on total probability, P ( C ) = P ( C | W ) P ( W ) + P ( C | R ) P ( R ) + P ( C | B ) P ( B ) = " 1 ·  3 3 ! + 1 ·  6 3 ! + 1 ·  3 3 !# · 1  12 3 ! 26. From a standard deck of 52 cards, one red one is taken. Thirteen cards are then chosen and found to be of the same color. What is the probability they are black? Solution: Given that the 13 cards are of the same color, they could be red ( R ) or black ( B ). Denote by C the event that all 13 cards are of the same color. It is required to ﬁnd P ( B | C ) . By Bayes theorem: P ( B | C ) = P ( C | B ) P ( B ) P ( C | B ) P ( B ) + P ( C | R ) P ( R ) =  26 13 ! /  51 13 !  26 13 ! /  51 13 ! +  25 13 ! /  51 13 ! . Since P ( C | R ) = P ( C | B ) = 1 , then P ( B | C ) 1 1 +  25 13 ! /  26 13 ! = 1 1 + 1 2 = 2 3  . and hence P ( C ) = 1 / 10 . 27. A fair die is tossed. If the face shows i then a fair coin is tossed i times. What is the probability of obtaining at least 3 heads on any given turn? Solution: Let A be the event of obtaining at least three heads on any outcome of the experiment and let B i be the event of obtaining i on the toss of a die, i = 1 , 2 , · · · , 6 . By the theorem on total probability, P ( A ) = 6 X i =1 P ( A | B i ) P ( B i ) . Now P ( B i ) = 1 / 6 and P ( A | B 1 ) = P ( A | B 2 ) = 0 and P ( A | B 3 ) = 1 8 P ( A | B 4 ) =  4 3 ! +  4 4 !!  1 2  4 P ( A | B 5 ) =  5 3 ! +  5 4 ! +  5 5 !!  1 2  5 P ( A | B 6 ) =  6 3 ! +  6 4 ! +  6 5 ! +  6 6 !!  1 2  6 and the result follows. ©A. K. Khandani, E&CE307—Fall 2024 44 28. If A and B are independent events and the probability that both A and B occur is .16 while the probability that neither occur is .36, determine P ( A ) and P ( B ) . Solution: From the problem statement, P ( AB ) = P ( A ) P ( B ) = 0 . 16 and P { ( A ∪ B ) c } = 0 . 36 from which it follows that P ( A ∪ B ) = 0 . 64 = P ( A ) + P ( B ) − 0 . 16 which gives two equations in two unknowns: ( i ) P ( A ) + P ( B ) = 0 . 80 ( ii ) P ( A ) P ( B ) = 0 . 16 which are easily solved to give P ( A ) = 0 . 40 and P ( B ) = 0 . 40 . 29. Of three coins, 2 are two-headed and the other is fair. From these three coins, one is chosen at random and tossed n times. If the results is all heads, what is the probability the coin tossed is two-headed? Solution: Let A be the event the coin is fair (i.e. two headed), B the event the coin is two-headed and C the event that n heads are obtained in n tosses of the coin. Then P ( C | B ) = 1 , P ( C | A ) = 1 / 2 n , P ( A ) = 1 / 3 and P ( B ) = 2 / 3 . By Bayes theorem: P ( B | C ) = P ( C | B ) P ( B ) P ( C | B ) P ( B ) + P ( C | A ) P ( A ) = 1 ·  2 3 1 ·  2 3 + 1 2 n · 1 3 = 2 n +1 2 n +1  + 1  . 30. A fair coin is thrown n times. (a) Show that the conditional probability of a head on any speciﬁed trial, given a total of k heads over the n trials, is k/n . (b) Suppose 0 ≤ r ≤ k and 0 < m < n are integers. Show that the conditional probability of r heads over the ﬁrst m trials, given a total of k heads over all n trials, is  m r ! n − m k − r ! /  n k ! . Solution: (a) Let A i be the event that a head is obtained on the i th trial and B k the event of obtaining k heads in n trials. Then P ( A i B k ) =  n − 1 k − 1 ! 1 2 n − 1 1 2  and P ( B k ) =  n k ! 1 2 n Thus P ( A i | B k ) =  n − 1 k − 1 ! 1 2 n  n k ! 1 2 n =  k n . (b) Let C r be the event of obtaining r heads in the ﬁrst m places. Then P ( B k C r ) is the probability of k heads in n throws with r of the k among the ﬁrst m . Then P ( C r | B k ) =  m r ! n − m k − r ! 2 n /  n k ! 2 n =  m r ! n − m k − r !  n k ! . ©A. K. Khandani, E&CE307—Fall 2024 45 31. Stores A,B and C have 50, 75 and 100 employees of which 50%, 60% and 70% respectively, are women. Resignations are equally likely among all employees, regardless of gender. One employee resigns and this is a woman. What is the probability she worked in store C? Solution: By straightforward application of Bayes theorem: P ( C | W ) = P ( W | C ) P ( C ) P ( W | C ) P ( C ) + P ( W | A ) P ( A ) + P ( W | B ) P ( B ) = 0 . 7 × (100 / 225) 0 . 7 × (100 / 225) + 0 . 5 × (50 / 225) + 0 . 6 × (75 / 225) = 70 70 + 25 + 45 = 1 2  . 32. Two hunters shoot at a deer which is hit by exactly one bullet. If the ﬁrst hunter hits his target with probability 0.3 and the second with probability 0.6, what is the probability the second hunter killed the deer? (The answer is not 2/3.) Solution: Let H 2 be the event that hunter 2 shot the deer and H c 2  the event that hunter 2 did not shoot the deer. Let B be the event that only one hunter shot the deer. Then P ( B ) = 0 . 3 × 0 . 4 + 0 . 7 × 0 . 6 = 0 . 12 + 0 . 42 = 0 . 54 and the conditional probability P ( H 2 | B ) = 0 . 42 0 . 12 + 0 . 42 = 42 54 = 7 9  . 33. You are about to have an interview for the Harvard Law School. 60% of the interviewers are conservative and 40% are liberal. 50% of the conservatives smoke cigars but only 25% of the liberals do. Your interviewer lights up a cigar. What is the probability he is a liberal? Solution: Let L = liberal and C = conservative and S = smoker. Then by Bayes’ theorem: P ( L | S ) = P ( S | L ) P ( L ) P ( S | L ) P ( L ) + P ( S | C ) P ( C ) = . 025 × 0 . 4 0 . 25 × 0 . 4 + 0 . 5 × 0 . 6 = 0 . 25 . 34. One slot machine pays oﬀ1/2 of the time. while another pays oﬀ1/4 of the time. A player picks one of the machines and plays it six times, winning three of the times. What is the probability he is playing the machine that pays oﬀ1/4 of the time? Solution: Let S 1 , S 2 be slot machine 1 and 2 respectively, and W 3 , 6 the event of winning 3 out of 6 with the machine being played. Then by Bayes theorem: P ( S 2 | W 3 , 6 ) = P ( W 3 , 6 | S 2 ) P ( S 2 ) P ( W 3 , 6 | S 2 ) P ( S 2 ) + P ( W 3 , 6 | S 1 ) P ( S 1 ) =  6 3 ! (1 / 4) 3 (3 / 4) 3 (1 / 2)  6 3 ! (1 / 4) 3 (3 / 4) 3 (1 / 2) +  6 3 ! (1 / 2) 6 (1 / 2) = 27 91  . 35. Consider a line AB divided into two parts by a point C , where the length of segment AC is greater than or equal to the length of segment CB (see the following ﬁgure). Suppose a point X is chosen at random along the segment AC and a point Y is chosen at random along the segment CB . Let x and y denote the ©A. K. Khandani, E&CE307—Fall 2024 46 Y y x A X C B b a distances of X and Y from A and B, respectively. What is the probability the three segments AX , XY , and Y B will ﬁt together to form a triangle? Solution: The key here is to recognize that three conditions must be met if the segments are to form a triangle - each segment must be shorter than the sum of the other two: 1 . x < ( a + b − x − y ) + y 2 . a + b − x − y < x + y 3 . y < x + ( a + b − x − y ) Intuitively, it seems clear that the probability of the segments forming a triangle will be greatest when C is the midpoint of AB : As b gets smaller, y tends to get smaller, and the likelihood of conditions (1) and (2) both being true diminishes. To make the argument precise, we need to determine what proportion of the sample space S = { ( x, y ) : 0 ≤ x ≤ a, 0 ≤ y ≤ b } is included in the ( x , y )-values satisfying conditions (1),(2), and (3). Note that 1 . x < ( a + b − x − y ) + y ⇒ x < a + b 2 2 . a + b − x − y < x + y ⇒ x + y > a + b 2 3 . y < x + ( a + b − x − y ) ⇒ y < a + b 2 The ( x , y )-values satisfying all three of these inequalities make up the interior of the triangle shown in the ﬁgure. Call that interior E . 0 ((a+b)/2,0) y x a (0,(a+b)/2) b ((a+b)/2,(a+b)/2) E S x+y=(a+b)/2 E U S ©A. K. Khandani, E&CE307—Fall 2024 47 It follows that the probability of the segments forming a triangle will equal the area of E ∩ S divided by the area of S : P ( segments form triangle ) = 1 2 b 2 ab = b 2 a As expected, the probability is greatest when C is midway between A and B , and it decreases fairly rapidly as C approaches B . 36. Consider the following connection of switches: A S 1 S 2 B S 4 S 3 Deﬁne the event: E i , i = 1 , 2 , 3 , 4 as: Switch S i is closed. Assume that P ( E 1 ) = P ( E 2 ) = P ( E 3 ) = P ( E 4 ) = a . Deﬁne the event E as the event that point A is connected to point B . Compute the probability of the event E . Solution: Consider the connection of switches shown in the above ﬁgure. Deﬁne the events: E 1 : Switch S 1 is closed. = ⇒ E c 1 : Switch S 1 is open. E 2 : Switch S 2 is closed. = ⇒ E c 2 : Switch S 2 is open. E 3 : Switch S 3 is closed. = ⇒ E c 3 : Switch S 3 is open. E 4 : Switch S 4 is closed. = ⇒ E c 4 : Switch S 4 is open. Assume that P ( E 1 ) = P ( E 2 ) = P ( E 3 ) = P ( E 4 ) = a , and consequently, P ( E c 1 ) = P ( E c 2 ) = P ( E c 3 ) = P ( E c 4 ) = 1 − a . Deﬁne the event E as the event that point A is connected to point B . What is P ( E ) . First method: E = [( E 1 E 2 ) ∪ E 3 ] E 4 P ( E ) = P [( E 1 E 2 ) ∪ E 3 ] × P ( E 4 ) P [( E 1 E 2 ) ∪ E 3 ] = P ( E 1 E 2 ) + P ( E 3 ) − P ( E 1 E 2 E 3 ) = a + a 2  − a 3 P ( E ) = a ( a + a 2  − a 3 ) = a 2  + a 3  − a 4 Second method (fallacy): P { E 4 [ E 3 ∪ ( E 1 E 2 )] } = P { E 4 [( E 3 ∪ E 1 )( E 3 ∪ E 2 )] } P ( E 3 ∪ E 1 ) = P ( E 3 ) + P ( E 1 ) − P ( E 3 E 1 ) = a + a − a 2  = 2 a − a 2 P ( E 3 ∪ E 2 ) = P ( E 3 ) + P ( E 2 ) − P ( E 3 E 2 ) = a + a − a 2  = 2 a − a 2 ©A. K. Khandani, E&CE307—Fall 2024 48 P { E 4 [( E 3 ∪ E 1 )( E 3 ∪ E 2 )] } = P ( E 4 ) × P ( E 3 ∪ E 1 ) × P ( E 3 ∪ E 2 ) = a (2 a − a 2 ) 2 It is seen that the two answers are diﬀerent. Why?! Third method: E c  = { [( E 1 E 2 ) ∪ E 3 ] E 4 } c  = E c 4  ∪{ [ E 3 ∪ ( E 1 E 2 )] } c = E c 4  ∪ [ E c 3 ( E c 1  ∪ E c 2 )] P ( E c ) = P { E c 4  ∪ [ E c 3 ( E c 1  ∪ E c 2 )] } = P ( E c 4 ) + P [ E c 3 ( E c 1  ∪ E c 2 )] − P [ E c 4 E c 3 ( E c 1  ∪ E c 2 )] P ( E c 4 ) = 1 − a P ( E c 1  ∪ E c 2 ) = (1 − a ) + (1 − a ) − (1 − a ) 2 = 1 − a 2 (this is indeed equal to P [( E 1 E 2 ) c ] ). P [ E c 4 E c 3 ( E c 1  ∪ E c 2 )] = (1 − a ) 2 (1 − a 2 ) Substituting results in P ( E c ) = P ( E c 4 ) + P [ E c 3 ( E c 1  ∪ E c 2 )] − P [ E c 4 E c 3 ( E c 1  ∪ E c 2 )] = (1 − a ) + (1 − a )(1 − a 2 ) − (1 − a ) 2 (1 − a 2 ) = 1 − ( a 2  + a 3  − a 4 ) . Which is in agreement with the previous result. Fourth method: Let 1 correspond to a closed switch and 0 correspond to an open switch. Using these notations, the sample space is represented as: S 4 S 3 S 2 S 1 e 1 0 0 0 0 e 2 0 0 0 1 e 3 0 0 1 0 e 4 0 0 1 1 e 5 0 1 0 0 e 6 0 1 0 1 e 7 0 1 1 0 e 8 0 1 1 1 e 9 1 0 0 0 e 10 1 0 0 1 e 11 1 0 1 0 OK e 12 1 0 1 1 a 3 (1 − a ) OK e 13 1 1 0 0 a 2 (1 − a ) 2 OK e 14 1 1 0 1 a 3 (1 − a ) OK e 15 1 1 1 0 a 3 (1 − a ) OK e 16 1 1 1 1 a 4 The e 1 , e 2 , . . . , e 16 are the elementary events. P ( E ) = P ( e 12 ∪ e 13 ∪ e 14 ∪ e 15 ∪ e 16 ) . As the elementary events are disjoint, the probabilities add. As a result, P ( E ) = P ( e 12 )+ P ( e 13 )+ P ( e 14 )+ P ( e 15 )+ P ( e 16 ) = a 3 (1 − a )+ a 2 (1 − a ) 2 + a 3 (1 − a )+ a 3 (1 − a )+ a 4  = a 2 + a 3 − a 4 . Which is in agreement with the previous result. ©A. K. Khandani, E&CE307—Fall 2024 49